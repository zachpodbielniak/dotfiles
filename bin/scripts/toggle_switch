#!/bin/bash 

# dotfiles - Personal configuration files and scripts
# Copyright (C) 2025  Zach Podbielniak
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.

set -euo pipefail 

unset SWITCHES
declare -A SWITCHES=(
    [fan-01]="b4_b0_24_29_80_df"
    [fan-02]="b4_b0_24_29_c2_2c"
    [lamp-01]="b4_b0_24_0e_09_83"
    [lamp-02]="b4_b0_24_0e_0d_c5"
    [lamp-03]="54_af_97_f4_25_28"
    [lamp-04]="28_87_ba_6a_2a_ef"
    [storage]="d8_47_32_9e_e9_15"
    [server]="6c_5a_b0_9b_38_ae"
)

if [[ ${#} -eq 0 ]]
then 
    echo "Usage: $(basename ${0}) <switch>"
    echo "${!SWITCHES[@]}"
    exit 1
fi

# iterate over all args
while [[ ${#} -gt 0 ]]
do 
    if [[ -n "${SWITCHES["$1"]}" ]] 
    then
       value=${SWITCHES["$1"]}
       distrobox enter dev -- hass-cli service call switch.toggle --arguments "entity_id=switch.${value}" >/dev/null
    else
       echo "${1} is not a valid switch"
       echo "${!SWITCHES[@]}"
       exit 1
    fi  
    shift
done

