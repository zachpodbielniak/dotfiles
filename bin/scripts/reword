#!/bin/bash
set -euo pipefail

input=""
provider="grokpy"
tone="professional"

print_help() {
    echo -e "Usage: $(basename ${0}) <args>"
    echo -e "  -h,--help\tshow this message"
    echo -e "  -p,--prompt\tset the prompt (in addition to stdin if passed)"
    echo -e "  -P,--provider\twhich ai provider to use (claudpy, grokpy, perpy, ollampy, geminpy, openpy)"
    echo -e "  -t,--tone\ttone to reword with (default: professional)"
}


while [[ $# -gt 0 ]]
do 
    case "${1}" in 
    -h|--help)
        print_help
        exit 0
        ;;
    -p|--prompt)
        input="${2}"
        shift
        ;;
    -P|--provider)
        provider="${2}"
        shift
        ;;
    -t|--tone)
        tone="${2}"
        shift
        ;;
    *)
        echo "${1} is an unknown parameter"
        print_help
        exit 1
        ;;
    esac
    shift
done


prompt="Please rephrase the following text to sound ${tone}. Provide only the reworded text without any additional explanation or analysis.\n\n"

if [[ "" != "${prompt}" ]]
then 
    prompt="${prompt}${input}\n"
fi

while IFS= read -r line 
do 
    # input+=("${line}")
    prompt="${prompt}${line}\n"
done

"${provider}" <<< "${prompt}"

