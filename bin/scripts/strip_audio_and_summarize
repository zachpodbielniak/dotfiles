#!/bin/bash 

input=""
output=""

if [[ $# -lt 1 ]]
then 
    echo "use this tool correctly:"
    echo "  ${0} <input_file> [output_file]"
fi

input="${1}"

if [[ $# -ge 2 ]]
then 
    output="${2}"
else 
    output="${input}.ogg"
fi

# strip audio from a video
strip_audio "${input}" "${output}"

# txt output stored in ${output}.txt
transcribe_audio "${output}"

# get a summary in markdown
ai_summary_as_markdown < "${output}.txt" > "${output}.md"

# place markdown copy on the clipboard
wl-copy < "${output}.md"

printf \
    "%s\n%s\n%s\n%s\n" \
    "audio file: ${output}" \
    "transcription: ${output}.txt" \
    "summary: ${output}.md" \
    "clipboard: summary in markdown"

