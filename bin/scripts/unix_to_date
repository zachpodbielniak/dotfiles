#!/bin/bash
set -euo pipefail
usage() { cat << 'USAGE'
unix_to_date - Convert Unix timestamp to human-readable date
USAGE: unix_to_date [OPTIONS] TIMESTAMP
OPTIONS:
-h, --help      Show this help message
--license       Show license information
--format FMT    Date format (default: +%Y-%m-%d %H:%M:%S)
EXAMPLES:
echo "1704067200" | unix_to_date
# Output: 2024-01-01 00:00:00
USAGE
exit 0; }
[[ "${1:-}" == "-h" || "${1:-}" == "--help" ]] && usage
[[ "${1:-}" == "--license" ]] && { echo "AGPLv3"; exit 0; }
format="+%Y-%m-%d %H:%M:%S"
[[ "${1:-}" == "--format" ]] && { format="${2}"; shift 2; }

# Read timestamp from stdin or command line argument
if [[ $# -gt 0 ]]; then
	timestamp="${1}"
else
	read -r timestamp
fi

[[ -z "$timestamp" ]] && { echo "unix_to_date: TIMESTAMP required" >&2; exit 1; }
date -d "@$timestamp" "$format"
